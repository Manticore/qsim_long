% =============================================================================
\section{Field operators and restricted basis}
% =============================================================================
\label{sec:func-operators}

For each component $j$ we define an orthonormal basis consisting of $\phi_{j,\nvec}(\xvec)$, where $\nvec \in \fullbasis_j$ is a mode identifier.
Orthonormality and completeness conditions for basis functions are, respectively,
\begin{eqns}
	\int\limits_A \phi_{j,\nvec}^* \phi_{j,\mvec} d\xvec = \delta_{\nvec\mvec}, \\
	\sum_{\nvec} \phi_{j,\nvec}^* \phi_{j,\nvec}^\prime = \delta(\xvec^\prime - \xvec),
\end{eqns}
where the exact nature of integration area $A$ depends on the basis set (for example, $A$ is the whole space for harmonic oscillator modes, or a box for plane waves).
Hereinafter we assume that the integration $\int d\xvec$ is always performed over $A$.

Standard bosonic field operators from~\eqnref{master-eqn:commutators} which project coordinates to the full Hilbert space $\mathbb{H}$ can be decomposed as
\begin{eqn}
    \Psiop_j \in (\mathbb{R}^D \rightarrow \mathbb{H}): \quad
	\Psiop_j = \sum_{\nvec \in \fullbasis_j} \phi_{j,\nvec} \hat{a}_{j,\nvec},
\end{eqn}
where single mode operators $\hat{a}_{j,\nvec}$ obey bosonic commutation relations, the pair $j,\nvec$ serving as a mode identifier.
The energy cutoff mentioned in the previous section will result in operating with some fixed subset of each component's basis.
Let $\restbasis_j \subseteq \fullbasis_j$ be this subset with cardinality $|\restbasis|$.
Restricted field operators contain only modes from the subset $\restbasis_j$:
\begin{eqn}
    \Psiop_j \in (\mathbb{R}^D \rightarrow \mathbb{H}_{\restbasis_j}): \quad
	\Psiop_j = \sum_{\nvec \in \restbasis_j} \phi_{j,\nvec} \hat{a}_{j,\nvec}.
\end{eqn}
In this paper we will use them without explicit indices in order to avoid clutter \todo{Should we explicitly mark ``full basis'' operators in the previous section?}.
Restricted field operators have the type $\mathbb{FH}_{\restbasis_j} \equiv (\mathbb{R}^D \rightarrow \mathbb{H}_{\restbasis_j})$, where $\mathbb{H}_{\restbasis_j}$ is the Hilbert space of the restricted subset of modes.

Because of the restricted nature of the operator, commutation relations~\eqnref{master-eqn:commutators} no longer apply.
The following ones should be used instead:
\begin{eqn}
\label{eqn:func-operators:restricted-commutators}
	\left[ \Psiop_j, \Psiop_k^\prime \right]
	& = \left[ \Psiop_j^\dagger, \Psiop_k^{\prime\dagger} \right] = 0, \\
	\left[ \Psiop_j, \Psiop_k^{\prime\dagger} \right]
	& = \delta_{jk} \delta_{\restbasis_j}(\xvec^\prime, \xvec),
\end{eqn}
where $\delta_{\restbasis_j}$ is the restricted delta-function from \defref{func-calculus:restricted-delta}.
