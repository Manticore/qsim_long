% =============================================================================
\section{Functional Fokker-Planck equation}
% =============================================================================

The general approach to numerical solution of the Fokker-Planck equation is to transform it to the equivalent set of stochastic differential equations (SDEs).
In the textbooks this transformation is defined for real variables only~\cite{Risken1996}, while we have functional FPE with complex-valued functions.

Our starting point is the reformulation of the theorem for real-valued multivariable FPE from~\cite{Risken1996} in terms of vectors and matrices:

\begin{lemma}[FPE--SDEs correspondence in convenient form.]
\label{lmm:app-fpe:fpe-sde-real}
    If $\zvec^T \equiv (z_1 \ldots z_M)$ is a set of real-valued variables,
    Fokker-Planck equation
    \begin{eqn*}
    	\frac{dW}{dt}
    	= -\boldsymbol{\partial}_{\zvec}^T \boldsymbol{a} W
    	+ \frac{1}{2} \Trace{ \boldsymbol{\partial}_{\zvec} \boldsymbol{\partial}_{\zvec}^T B B^T } W
    \end{eqn*}
    is equivalent to a set of stochastic differential equations in It\^{o} form
    \begin{eqn*}
    	d\zvec = \boldsymbol{a} dt + B d\Zvec
    \end{eqn*}
    and to a set of stochastic differential equations in Stratonovich form
    \begin{eqn*}
    	d\zvec = (\boldsymbol{a} - \boldsymbol{s})dt + B d\Zvec,
    \end{eqn*}
    where the noise-induced (or spurious) drift vector $\boldsymbol{s}$ has elements
    \begin{eqn*}
    	s_i
    	= \sum_{k,j} B_{kj} \frac{\partial}{\partial z_k} B_{ij}
    	= \Trace{B^T \boldsymbol{\partial}_z \boldsymbol{e}_i^T B},
    \end{eqn*}
    $\boldsymbol{e}_i$ being the unit vector with elements $(\boldsymbol{e}_i)_j = \delta_{ij}$.
    Here $W \equiv W(\zvec)$ is a probability distribution,
    $\boldsymbol{a} \equiv \boldsymbol{a}(\zvec)$ is a vector function,
    $B \equiv B(\zvec)$ is a matrix function ($B$ having size $M \times L$, where $L$ corresponds to the number of noise sources),
    $\boldsymbol{\partial}_{\zvec}^T \equiv (\partial_{z_1} \ldots \partial_{z_M})$ is a vector differential,
    and $d\Zvec$ is a standard $L$-dimensional real-valued Wiener process.
\end{lemma}
\begin{proof}
For details see~\cite{Risken1996}, sections 3.3 and 3.4.
\end{proof}

\begin{theorem}
\label{thm:app-fpe:fpe-sde-complex}
    If $\boldsymbol{\alpha}^T \equiv (\alpha_1 \ldots \alpha_M)$ is a set of complex-valued variables,
    Fokker-Planck equation
    \begin{eqn*}
    	\frac{dW}{dt}
    	= -\boldsymbol{\partial}_{\boldsymbol{\alpha}}^T \boldsymbol{a} W - \boldsymbol{\partial}_{\boldsymbol{\alpha}^*}^T \boldsymbol{a}^* W
    	+ \Trace{ \boldsymbol{\partial}_{\boldsymbol{\alpha}^*} \boldsymbol{\partial}_{\boldsymbol{\alpha}}^T B B^H } W
    \end{eqn*}
    is equivalent to a set of stochastic differential equations in It\^{o} form
    \begin{eqn*}
    	d\boldsymbol{\alpha} = \boldsymbol{a} dt + B d\Zvec,
    \end{eqn*}
    or to Stratonovich form
    \begin{eqn*}
    	d\boldsymbol{\alpha} = (\boldsymbol{a} - \boldsymbol{s}) dt + B d\Zvec,
    \end{eqn*}
    where noise-induced drift term is
    \begin{eqn*}
    	s_j = \Trace{ B^H \boldsymbol{\partial}_{\boldsymbol{\alpha}^*} \boldsymbol{e}_j^T B },
    \end{eqn*}
    and $d\Zvec = (d\boldsymbol{X} + id\boldsymbol{Y}) / \sqrt{2}$ is an $M$-dimensional complex-valued Wiener process,
    containing two real-valued $L$-dimensional Wiener processes $d\boldsymbol{X}$ and $d\boldsymbol{Y}$.
\end{theorem}
\begin{proof}
Proved straightforwardly by transforming the equation to real variables and applying \lmmref{app-fpe:fpe-sde-real}.
\end{proof}

\begin{theorem}[Multi-component extension of \thmref{app-fpe:fpe-sde-complex}]
\label{thm:app-fpe:mc-fpe-sde}
    If $\boldsymbol{\alpha}^{(c)},\, c = 1..C$ are $C$ sets of complex variables $\boldsymbol{\alpha}^{(c)} \equiv (\alpha_1^{(c)} \ldots \alpha_M^{(c)})$, then the Fokker-Planck equation
    \begin{eqn}
    	\frac{dW}{dt}
    	= & - \sum_{c=1}^C \boldsymbol{\partial}_{\boldsymbol{\alpha}^{(c)}}^T \boldsymbol{a}^{(c)} W
    	- \sum_{c=1}^C \boldsymbol{\partial}_{(\boldsymbol{\alpha}^{(c)})^*}^T (\boldsymbol{a}^{(c)})^* W \\
        & + \sum_{m=1}^c \sum_{n=1}^c
    		\Trace{
    			\boldsymbol{\partial}_{(\boldsymbol{\alpha}^{(m)})^*}
    			\boldsymbol{\partial}_{\boldsymbol{\alpha}^{(n)}}^T
    			B^{(n)} (B^{(m)})^H
    		} W
    \end{eqn}
    is equivalent to a set of stochastic differential equations in It\^{o} form
    \begin{eqn}
    	d\boldsymbol{\alpha}^{(c)} = \boldsymbol{a}^{(c)} dt + B^{(c)} d\Zvec,\, c = 1..C
    \end{eqn}
    or to Stratonovich form
    \begin{eqn*}
    	d\boldsymbol{\alpha}^{(c)} = (\boldsymbol{a}^{(c)} - \boldsymbol{s}^{(c)}) dt + B^{(c)} d\Zvec,
    \end{eqn*}
    where noise-induced drift term is
    \begin{eqn*}
    	s_j^{(c)} = \sum_{d=1}^C
    		\Trace{ (B^{(d)})^H \boldsymbol{\partial}_{(\boldsymbol{\alpha}^{(d)})^*} \boldsymbol{e}_j^T B^{(c)} },
    \end{eqn*}
    and $d\Zvec$ is an $L$-dimensional complex-valued Wiener process.
\end{theorem}
\begin{proof}
Proved by joining vectors from all components into one vector and applying \thmref{app-fpe:fpe-sde-complex}.
\end{proof}

\begin{theorem}
\label{thm:app-fpe:fpe-sde-func}
    For the probability distribution $W[\Psivec, \Psivec^*] \in (\mathbb{F}_{\restbasis}^C \rightarrow \mathbb{R})$ the functional FPE
    \begin{eqn*}
\fl    	\frac{dW}{dt}
    	= \int d\xvec \left(
    		- \sum_{j=1}^C \frac{\delta}{\delta \Psi_j} \mathcal{A}_j
    		- \sum_{j=1}^C \frac{\delta}{\delta \Psi_j^*} \mathcal{A}_j^*
    		+ \sum_{j=1}^C \sum_{k=1}^C \frac{\delta^2}{\delta \Psi_j^* \delta \Psi_k}
    			\sum_{\lvec} \mathcal{B}_{\lvec}^{(k)} (\mathcal{B}_{\lvec}^{(j)})^*
    	\right) W
    \end{eqn*}
    is equivalent to the set of SDEs in It\^{o} form
    \begin{eqn*}
    	d\Psi_j = \mathcal{P}_{\restbasis_j} \left[
    		\mathcal{A}^{(j)} dt + \sum_{\lvec} \mathcal{B}_{\lvec}^{(j)} dQ_{\lvec}
    	\right],
    \end{eqn*}
    or in Stratonovich form
    \begin{eqn*}
    	d\Psi_j = \mathcal{P}_{\restbasis_j} \left[
    		(\mathcal{A}^{(j)} - \mathcal{S}^{(j)}) dt + \sum_{\lvec} \mathcal{B}_{\lvec}^{(j)} dQ_{\lvec}
    	\right],
    \end{eqn*}
    where
    \begin{eqn*}
    	\mathcal{S}^{(j)} = \sum_{c=1}^C \sum_{\lvec}
    		(\mathcal{B}_{\lvec}^{(c)})^*
    		\frac{\delta}{\delta \Psi_c^*}
    		\mathcal{B}_{\lvec}^{(j)},
    \end{eqn*}
    and $Q_{\lvec}$ is a functional Wiener process:
    \begin{eqn*}
    	Q_{\lvec} = \sum_{\nvec \in \fullbasis} \phi_{\nvec} Z_{\lvec,\nvec}.
    \end{eqn*}
\end{theorem}
\begin{proof}
Proved by expanding functional derivatives and applying \thmref{app-fpe:mc-fpe-sde}.
The diffusion term has to be transformed in order to conform to the theorem:
\begin{eqn}
\fl	\int d\xvec \phi_{j,\mvec} \phi_{k,\nvec}^* \sum_{\lvec} \mathcal{B}_{\lvec}^{(k)} (\mathcal{B}_{\lvec}^{(j)})^*
	& = \int d\xvec \int d\xvec^\prime
			\phi_{j,\mvec}^\prime \phi_{k,\nvec}^*
			\sum_{\lvec} (\mathcal{B}_{\lvec}^{(j)})^{\prime *} \mathcal{B}_{\lvec}^{(k)}
			\delta(\xvec - \xvec^\prime) \\
	& = \int d\xvec \int d\xvec^\prime
			\phi_{j,\mvec}^\prime \phi_{k,\nvec}^*
			\sum_{\lvec} (\mathcal{B}_{\lvec}^{(j)})^{\prime *} \mathcal{B}_{\lvec}^{(k)}
			\sum_{\pvec \in \fullbasis} \phi_{\pvec}^{\prime*} \phi_{\pvec} \\
	& = \sum_{\pvec \in \fullbasis, \lvec}
		\int d\xvec
			\phi_{j,\mvec} (\mathcal{B}_{\lvec}^{(j)})^* \phi_{\pvec}^*
		\int d\xvec
			\phi_{k,\nvec}^* \mathcal{B}_{\lvec}^{(k)} \phi_{\pvec}
\end{eqn}
Grouping terms back and recognising the definition of projection transformation, one gets the statement of the theorem.
\end{proof}
